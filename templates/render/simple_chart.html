{# 渲染图模板 #}
{% extends "render/topolayout.html" %}
{% import 'render/macro' as macro %}
{% block headscript %}
    {{ macro.render_chart_dependencies(chart) }}
{% endblock %}

{% block title_and_others %}
    <div class="alert alert-primary" role="alert">
        图表示例
    </div>
{% endblock %}

{% block widget %}
    <div class="container">
        <div class="row">
            <div class="col-auto mr-auto">
                <form action="" method="post" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="inputTopo">Topo</label>
                        <select name="TopoName" id="inputTopo" class="form-control">
                            <option selected value="topo66.json">topo66</option>
                            <option value="topo.json">topo</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">更换拓扑</button>
                </form>
            </div>
            <div class="col-auto">
                <div class="form-group">

                    <label for="exampleFormControlTextarea1">删除节点之间的连接</label>
                    <input class="form-control" id="node1">
                    <input class="form-control" id="node2">
                    <button onclick="deleteLink()">删除连接</button>
                    <script>
                        deleteLink = function (){
                            const node1 = document.getElementById("node1").value;
                            const node2 = document.getElementById("node2").value;
                            for (let i = 0; i < option_graph1.series[0].links.length; i++) {
                                if (option_graph1.series[0].links[i].source === node1
                                    && option_graph1.series[0].links[i].target === node2) {
                                    option_graph1.series[0].links.splice(i, 1)
                                }
                                if (option_graph1.series[0].links[i].source === node2
                                    && option_graph1.series[0].links[i].target === node1) {
                                    option_graph1.series[0].links.splice(i, 1)
                                }
                            }
                            chart_graph1.setOption(option_graph1);
                        }
                    </script>
                </div>
            </div>
            <div class="col-auto">
                <button type="button" class="btn btn-success">预览效果</button>
                <button type="button" class="btn btn-primary">保存并刷新</button>
            </div>

        </div>
    </div>
    <br>
{% endblock %}

{% block graph %}
    {{ macro.render_chart_content(chart) }}
{% endblock %}


{% block messages %}
    <div>
        <p><strong>生成方法：</strong></p>
        <p>详见generate.py文件</p>
        <p><strong>下一步工作：</strong></p>
        <ul>
            <li>格式化json文件(已完成)</li>
            <li>制作交换机图标和端口</li>

        </ul>
        <p><strong>再下一步工作：</strong></p>
        <ul>
            <li>在页面上编写控件，通过修改json更新拓扑图</li>
            <li>[可选] 在拓扑图的组件上使用tooltip</li>

        </ul>
    </div>

{% endblock %}
